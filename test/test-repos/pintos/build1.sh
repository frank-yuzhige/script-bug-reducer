gcc -m32 -E -nostdinc -I../.. -I../../lib -I../../lib/kernel -P ../../threads/kernel.lds.S >threads/kernel.lds.s;
gcc -m32 -c ../../threads/start.S -o threads/start.o -Wa,--gstabs -nostdinc -I../.. -I../../lib -I../../lib/kernel -MMD -MF threads/start.d;
gcc -m32 -c ../../threads/init.c -o threads/init.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF threads/init.d;
gcc -m32 -c ../../threads/thread.c -o threads/thread.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF threads/thread.d;
gcc -m32 -c ../../threads/switch.S -o threads/switch.o -Wa,--gstabs -nostdinc -I../.. -I../../lib -I../../lib/kernel -MMD -MF threads/switch.d;
gcc -m32 -c ../../threads/interrupt.c -o threads/interrupt.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF threads/interrupt.d;
gcc -m32 -c ../../threads/intr-stubs.S -o threads/intr-stubs.o -Wa,--gstabs -nostdinc -I../.. -I../../lib -I../../lib/kernel -MMD -MF threads/intr-stubs.d;
gcc -m32 -c ../../threads/synch.c -o threads/synch.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF threads/synch.d;
gcc -m32 -c ../../threads/palloc.c -o threads/palloc.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF threads/palloc.d;
gcc -m32 -c ../../threads/malloc.c -o threads/malloc.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF threads/malloc.d;
gcc -m32 -c ../../devices/pit.c -o devices/pit.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/pit.d;
gcc -m32 -c ../../devices/timer.c -o devices/timer.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/timer.d;
gcc -m32 -c ../../devices/kbd.c -o devices/kbd.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/kbd.d;
gcc -m32 -c ../../devices/vga.c -o devices/vga.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/vga.d;
gcc -m32 -c ../../devices/serial.c -o devices/serial.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/serial.d;
gcc -m32 -c ../../devices/block.c -o devices/block.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/block.d;
gcc -m32 -c ../../devices/partition.c -o devices/partition.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/partition.d;
gcc -m32 -c ../../devices/ide.c -o devices/ide.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/ide.d;
gcc -m32 -c ../../devices/input.c -o devices/input.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/input.d;
gcc -m32 -c ../../devices/intq.c -o devices/intq.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/intq.d;
gcc -m32 -c ../../devices/rtc.c -o devices/rtc.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/rtc.d;
gcc -m32 -c ../../devices/shutdown.c -o devices/shutdown.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/shutdown.d;
gcc -m32 -c ../../devices/speaker.c -o devices/speaker.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF devices/speaker.d;
gcc -m32 -c ../../lib/debug.c -o lib/debug.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/debug.d;
gcc -m32 -c ../../lib/random.c -o lib/random.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/random.d;
gcc -m32 -c ../../lib/stdio.c -o lib/stdio.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/stdio.d;
gcc -m32 -c ../../lib/stdlib.c -o lib/stdlib.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/stdlib.d;
gcc -m32 -c ../../lib/string.c -o lib/string.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/string.d;
gcc -m32 -c ../../lib/arithmetic.c -o lib/arithmetic.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/arithmetic.d;
gcc -m32 -c ../../lib/ustar.c -o lib/ustar.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/ustar.d;
gcc -m32 -c ../../lib/kernel/debug.c -o lib/kernel/debug.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/kernel/debug.d;
gcc -m32 -c ../../lib/kernel/list.c -o lib/kernel/list.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/kernel/list.d;
gcc -m32 -c ../../lib/kernel/bitmap.c -o lib/kernel/bitmap.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/kernel/bitmap.d;
gcc -m32 -c ../../lib/kernel/hash.c -o lib/kernel/hash.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/kernel/hash.d;
gcc -m32 -c ../../lib/kernel/console.c -o lib/kernel/console.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF lib/kernel/console.d;
gcc -m32 -c ../../tests/devices/tests.c -o tests/devices/tests.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/tests.d;
gcc -m32 -c ../../tests/devices/alarm-wait.c -o tests/devices/alarm-wait.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/alarm-wait.d;
gcc -m32 -c ../../tests/devices/alarm-simultaneous.c -o tests/devices/alarm-simultaneous.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/alarm-simultaneous.d;
gcc -m32 -c ../../tests/devices/alarm-no-busy-wait.c -o tests/devices/alarm-no-busy-wait.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/alarm-no-busy-wait.d;
gcc -m32 -c ../../tests/devices/alarm-one.c -o tests/devices/alarm-one.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/alarm-one.d;
gcc -m32 -c ../../tests/devices/alarm-zero.c -o tests/devices/alarm-zero.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/alarm-zero.d;
gcc -m32 -c ../../tests/devices/alarm-negative.c -o tests/devices/alarm-negative.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/alarm-negative.d;
gcc -m32 -c ../../tests/devices/test_buggy.c -o tests/devices/test_buggy.o -g -msoft-float -O -fno-omit-frame-pointer -ffreestanding -fno-pic -fno-stack-protector -nostdinc -I../.. -I../../lib -I../../lib/kernel -Wall -W -Wstrict-prototypes -Wmissing-prototypes -Wsystem-headers -Wno-frame-address -MMD -MF tests/devices/test_buggy.d;
ld -melf_i386 -T threads/kernel.lds.s -o kernel.o threads/start.o threads/init.o threads/thread.o threads/switch.o threads/interrupt.o threads/intr-stubs.o threads/synch.o threads/palloc.o threads/malloc.o devices/pit.o devices/timer.o devices/kbd.o devices/vga.o devices/serial.o devices/block.o devices/partition.o devices/ide.o devices/input.o devices/intq.o devices/rtc.o devices/shutdown.o devices/speaker.o lib/debug.o lib/random.o lib/stdio.o lib/stdlib.o lib/string.o lib/arithmetic.o lib/ustar.o lib/kernel/debug.o lib/kernel/list.o lib/kernel/bitmap.o lib/kernel/hash.o lib/kernel/console.o tests/devices/tests.o tests/devices/alarm-wait.o tests/devices/alarm-simultaneous.o tests/devices/alarm-no-busy-wait.o tests/devices/alarm-one.o tests/devices/alarm-zero.o tests/devices/alarm-negative.o tests/devices/test_buggy.o;
objcopy -R .note -R .comment -S kernel.o kernel.bin;
gcc -m32 -c ../../threads/loader.S -o threads/loader.o -Wa,--gstabs -nostdinc -I../.. -I../../lib;
ld -melf_i386 -N -e 0 -Ttext 0x7c00 --oformat binary -o loader.bin threads/loader.o;